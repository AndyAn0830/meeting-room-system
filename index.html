<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœƒè­°å®¤å€Ÿç”¨ç³»çµ±</title>
    <meta name="description" content="æœƒè­°å®¤å€Ÿç”¨ç®¡ç†ç³»çµ± - æ”¯æ´QR Codeæƒæå€Ÿç”¨">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function MeetingRoomSystem() {
          // æœƒè­°å®¤è³‡æ–™
          const [rooms] = useState([
            { id: 1, name: 'ç¬¬ä¸€æœƒè­°å®¤' },
            { id: 2, name: 'äºŒæœŸè¬›å ‚' },
            { id: 3, name: 'åˆå¿ƒæœƒè­°å®¤' },
            { id: 4, name: 'å’Œæ°£æœƒè­°å®¤' },
            { id: 5, name: 'äº’æ„›æœƒè­°å®¤' },
            { id: 6, name: 'è²´è³“å®¤' },
            { id: 7, name: 'å”åŠ›è¬›å ‚' }
          ]);

          // å€Ÿç”¨è¨˜éŒ„ - ç°¡åŒ–ç‰ˆï¼ŒåŠ å…¥åŒ¯å‡ºåŠŸèƒ½
          const [bookings, setBookings] = useState(() => {
            try {
              const saved = localStorage.getItem('meetingRoomBookings');
              return saved ? JSON.parse(saved) : [];
            } catch (error) {
              console.error('è®€å–å„²å­˜è³‡æ–™å¤±æ•—:', error);
              return [];
            }
          });

          // åŒ¯å‡ºè³‡æ–™åŠŸèƒ½
          const exportData = () => {
            const dataStr = JSON.stringify(bookings, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `æœƒè­°å®¤å€Ÿç”¨è¨˜éŒ„_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
          };

          // åŒ¯å…¥è³‡æ–™åŠŸèƒ½
          const importData = (event) => {
            const file = event.target.files[0];
            if (file) {
              const reader = new FileReader();
              reader.onload = (e) => {
                try {
                  const importedData = JSON.parse(e.target.result);
                  setBookings(importedData);
                  alert('è³‡æ–™åŒ¯å…¥æˆåŠŸï¼');
                } catch (error) {
                  alert('åŒ¯å…¥å¤±æ•—ï¼Œæª”æ¡ˆæ ¼å¼éŒ¯èª¤');
                }
              };
              reader.readAsText(file);
            }
          };

          // é›²ç«¯åŒæ­¥æç¤º
          const showSyncInfo = () => {
            alert(`ğŸ“±ğŸ’» è³‡æ–™åŒæ­¥èªªæ˜ï¼š\n\nç”±æ–¼æŠ€è¡“é™åˆ¶ï¼Œæ‰‹æ©Ÿå’Œé›»è…¦çš„è¨˜éŒ„æ˜¯åˆ†é–‹å„²å­˜çš„ã€‚\n\nå»ºè­°åšæ³•ï¼š\nâ€¢ åŒäº‹ç”¨æ‰‹æ©Ÿå€Ÿç”¨\nâ€¢ ç®¡ç†å“¡ç”¨å›ºå®šé›»è…¦æŸ¥çœ‹è¨˜éŒ„\nâ€¢ æˆ–ä½¿ç”¨ã€ŒåŒ¯å‡ºè¨˜éŒ„ã€åŠŸèƒ½å‚™ä»½è³‡æ–™`);
          };
          
          // è¡¨å–®è³‡æ–™ - å¾ URL åƒæ•¸è‡ªå‹•å¡«å…¥æœƒè­°å®¤
          const [formData, setFormData] = useState(() => {
            const urlParams = new URLSearchParams(window.location.search);
            const roomParam = urlParams.get('room');
            
            return {
              roomId: roomParam || '',
              department: '',
              borrower: '',
              extension: '',
              date: '',
              startTime: ''
            };
          });

          // ç³»çµ±æ¨¡å¼ï¼šuser(ä½¿ç”¨è€…) æˆ– admin(ç®¡ç†å“¡)
          const [systemMode, setSystemMode] = useState('user');
          
          // ç®¡ç†å“¡ç™»å…¥ç‹€æ…‹
          const [showLoginModal, setShowLoginModal] = useState(false);
          const [loginData, setLoginData] = useState({
            username: '',
            password: ''
          });
          
          // ç®¡ç†å“¡é é¢
          const [adminView, setAdminView] = useState('records');
          const [recordView, setRecordView] = useState('current');
          const [selectedBookings, setSelectedBookings] = useState([]);
          
          // æ‰‹å‹•æ–°å¢è¨˜éŒ„çš„è¡¨å–®
          const [showManualAdd, setShowManualAdd] = useState(false);
          const [manualFormData, setManualFormData] = useState({
            roomId: '',
            department: '',
            borrower: '',
            extension: '',
            date: '',
            startTime: ''
          });

          // å„²å­˜åˆ° localStorage - åŠ å¼·ç‰ˆæœ¬
          React.useEffect(() => {
            try {
              localStorage.setItem('meetingRoomBookings', JSON.stringify(bookings));
              console.log('è³‡æ–™å·²å„²å­˜ï¼Œå…±', bookings.length, 'ç­†è¨˜éŒ„');
            } catch (error) {
              console.error('å„²å­˜è³‡æ–™å¤±æ•—:', error);
              alert('âš ï¸ è³‡æ–™å„²å­˜å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç€è¦½å™¨è¨­å®šæˆ–æ¸…é™¤ç€è¦½å™¨è³‡æ–™å¾Œé‡è©¦');
            }
          }, [bookings]);

          // è™•ç†ç™»å…¥è¡¨å–®è¼¸å…¥
          const handleLoginInputChange = (e) => {
            const { name, value } = e.target;
            setLoginData(prev => ({
              ...prev,
              [name]: value
            }));
          };

          // ç®¡ç†å“¡ç™»å…¥é©—è­‰
          const handleAdminLogin = () => {
            if (loginData.username === 'hl1234' && loginData.password === 'admin1234') {
              setSystemMode('admin');
              setShowLoginModal(false);
              setLoginData({ username: '', password: '' });
              alert('ç™»å…¥æˆåŠŸï¼æ­¡è¿ä½¿ç”¨ç®¡ç†ç³»çµ±');
            } else {
              alert('å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼è«‹é‡æ–°è¼¸å…¥');
              setLoginData({ username: '', password: '' });
            }
          };

          // è™•ç†è¡¨å–®è¼¸å…¥
          const handleInputChange = (e) => {
            const { name, value } = e.target;
            setFormData(prev => ({
              ...prev,
              [name]: value
            }));
          };

          // ä½¿ç”¨è€…å€Ÿç”¨æäº¤ - æ”¹è‰¯ç‰ˆï¼ŒåŠ å…¥é€šçŸ¥åŠŸèƒ½
          const handleUserBookingSubmit = () => {
            console.log('é–‹å§‹è™•ç†å€Ÿç”¨ç”³è«‹...');
            
            if (!formData.roomId || !formData.department || !formData.borrower || !formData.extension || !formData.date || !formData.startTime) {
              alert('è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½ï¼');
              return;
            }

            const selectedRoom = rooms.find(room => room.id === parseInt(formData.roomId));
            console.log('é¸æ“‡çš„æœƒè­°å®¤:', selectedRoom);
            
            const hasConflict = bookings.some(booking => 
              booking.roomId === parseInt(formData.roomId) &&
              booking.date === formData.date &&
              booking.startTime === formData.startTime &&
              booking.status === 'å€Ÿç”¨ä¸­'
            );

            if (hasConflict) {
              alert('è©²æœƒè­°å®¤åœ¨æ­¤æ™‚é–“å·²è¢«é ç´„ï¼è«‹é¸æ“‡å…¶ä»–æ™‚é–“ã€‚');
              return;
            }

            const newBooking = {
              id: Date.now(),
              roomId: parseInt(formData.roomId),
              roomName: selectedRoom.name,
              department: formData.department,
              borrower: formData.borrower,
              extension: formData.extension,
              date: formData.date,
              startTime: formData.startTime,
              status: 'å€Ÿç”¨ä¸­',
              bookingTime: new Date().toLocaleString(),
              deviceType: window.innerWidth > 768 ? 'desktop' : 'mobile'
            };

            console.log('æ–°å¢å€Ÿç”¨è¨˜éŒ„:', newBooking);

            try {
              const newBookings = [...bookings, newBooking];
              setBookings(newBookings);
              console.log('å€Ÿç”¨è¨˜éŒ„å·²æ›´æ–°ï¼Œç¸½å…±', newBookings.length, 'ç­†');
              
              // ç«‹å³é©—è­‰æ˜¯å¦å„²å­˜æˆåŠŸ
              setTimeout(() => {
                const savedData = localStorage.getItem('meetingRoomBookings');
                const parsedData = savedData ? JSON.parse(savedData) : [];
                console.log('é©—è­‰å„²å­˜çµæœ:', parsedData.length, 'ç­†è¨˜éŒ„');
                
                if (parsedData.length > bookings.length) {
                  alert(`ğŸ‰ å€Ÿç”¨æˆåŠŸï¼\n\nâœ… æœƒè­°å®¤ï¼š${selectedRoom.name}\nğŸ¢ å€Ÿç”¨å–®ä½ï¼š${formData.department}\nğŸ‘¤ å€Ÿç”¨äººï¼š${formData.borrower}\nğŸ“ åˆ†æ©Ÿï¼š${formData.extension}\nğŸ“… æ—¥æœŸï¼š${formData.date}\nâ° æ™‚é–“ï¼š${formData.startTime}\n\nè«‹åˆ°æ«ƒå°ç´¢å–é‘°åŒ™ï¼Œä¸¦å‘ŠçŸ¥å·¥ä½œäººå“¡æ‚¨çš„å€Ÿç”¨è³‡è¨Šã€‚\n\nè¨˜éŒ„ID: ${newBooking.id}`);
                } else {
                  alert('âš ï¸ å€Ÿç”¨æˆåŠŸä½†è³‡æ–™å¯èƒ½æœªæ­£ç¢ºå„²å­˜ï¼Œè«‹æˆªåœ–æ­¤è¨Šæ¯çµ¦ç®¡ç†å“¡\n\nè¨˜éŒ„ID: ' + newBooking.id);
                }
              }, 100);
              
            } catch (error) {
              console.error('æ–°å¢è¨˜éŒ„å¤±æ•—:', error);
              alert('âŒ å€Ÿç”¨å¤±æ•—ï¼Œè«‹é‡è©¦æˆ–è¯çµ¡ç®¡ç†å“¡');
              return;
            }
            
            setFormData({
              roomId: '',
              department: '',
              borrower: '',
              extension: '',
              date: '',
              startTime: ''
            });
          };

          // ç®¡ç†å“¡åŠŸèƒ½
          const handleCheckboxChange = (bookingId) => {
            if (selectedBookings.includes(bookingId)) {
              setSelectedBookings(selectedBookings.filter(id => id !== bookingId));
            } else {
              setSelectedBookings([...selectedBookings, bookingId]);
            }
          };

          const returnSelectedBookings = () => {
            if (selectedBookings.length === 0) {
              alert('è«‹å…ˆé¸æ“‡è¦æ­¸é‚„çš„è¨˜éŒ„ï¼');
              return;
            }
            
            const currentTime = new Date().toLocaleString();
            const newBookings = bookings.map(booking => {
              if (selectedBookings.includes(booking.id) && booking.status === 'å€Ÿç”¨ä¸­') {
                return {
                  ...booking,
                  status: 'å·²æ­¸é‚„',
                  returnTime: currentTime
                };
              }
              return booking;
            });
            
            setBookings(newBookings);
            setSelectedBookings([]);
            alert(`å·²æ­¸é‚„ ${selectedBookings.length} ç­†è¨˜éŒ„ï¼`);
          };

          // æ‰‹å‹•æ–°å¢è¨˜éŒ„åŠŸèƒ½
          const handleManualInputChange = (e) => {
            const { name, value } = e.target;
            setManualFormData(prev => ({
              ...prev,
              [name]: value
            }));
          };

          const handleManualAdd = () => {
            if (!manualFormData.roomId || !manualFormData.department || !manualFormData.borrower || !manualFormData.extension || !manualFormData.date || !manualFormData.startTime) {
              alert('è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½ï¼');
              return;
            }

            const selectedRoom = rooms.find(room => room.id === parseInt(manualFormData.roomId));
            
            const hasConflict = bookings.some(booking => 
              booking.roomId === parseInt(manualFormData.roomId) &&
              booking.date === manualFormData.date &&
              booking.startTime === manualFormData.startTime &&
              booking.status === 'å€Ÿç”¨ä¸­'
            );

            if (hasConflict) {
              alert('è©²æœƒè­°å®¤åœ¨æ­¤æ™‚é–“å·²è¢«é ç´„ï¼è«‹é¸æ“‡å…¶ä»–æ™‚é–“ã€‚');
              return;
            }

            const newBooking = {
              id: Date.now(),
              roomId: parseInt(manualFormData.roomId),
              roomName: selectedRoom.name,
              department: manualFormData.department,
              borrower: manualFormData.borrower,
              extension: manualFormData.extension,
              date: manualFormData.date,
              startTime: manualFormData.startTime,
              status: 'å€Ÿç”¨ä¸­',
              bookingTime: new Date().toLocaleString(),
              deviceType: 'manual-admin'
            };

            setBookings([...bookings, newBooking]);
            setManualFormData({
              roomId: '',
              department: '',
              borrower: '',
              extension: '',
              date: '',
              startTime: ''
            });
            setShowManualAdd(false);
            alert('æ‰‹å‹•è¨˜éŒ„æ–°å¢æˆåŠŸï¼');
          };

          // ä½¿ç”¨è€…ä»‹é¢ï¼ˆå‰å°ï¼‰
          if (systemMode === 'user') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                {/* æ‰‹æ©Ÿç‰ˆæ¨™é¡Œ */}
                <div className="bg-white shadow-md p-4 mb-4 relative">
                  <div className="text-center">
                    <div className="text-4xl mb-2">ğŸ¢</div>
                    <h1 className="text-xl font-bold text-gray-800">æœƒè­°å®¤å€Ÿç”¨ç³»çµ±</h1>
                    <p className="text-sm text-gray-600">è«‹å¡«å¯«å€Ÿç”¨è³‡è¨Š</p>
                  </div>
                  
                  <button
                    onClick={() => setShowLoginModal(true)}
                    className="absolute top-4 right-4 bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600"
                  >
                    ğŸ”§ ç®¡ç†å“¡
                  </button>
                </div>

                <div className="px-4 pb-4">
                  {/* QR Code æç¤ºå¡ç‰‡ */}
                  {formData.roomId && (
                    <div className="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded-r-lg">
                      <div className="flex items-center">
                        <div className="text-xl mr-3">ğŸ“±</div>
                        <div>
                          <p className="font-medium text-blue-800">
                            æ‚¨æ­£åœ¨å€Ÿç”¨ï¼š{rooms.find(r => r.id === parseInt(formData.roomId))?.name}
                          </p>
                          <p className="text-sm text-blue-700">è«‹ç¹¼çºŒå¡«å¯«å…¶ä»–è³‡è¨Š</p>
                        </div>
                      </div>
                    </div>
                  )}

                  {/* å€Ÿç”¨è¡¨å–® */}
                  <div className="bg-white rounded-lg shadow-md">
                    <div className="p-4 border-b border-gray-200">
                      <h2 className="text-lg font-bold text-gray-800">ğŸ“ å€Ÿç”¨ç”³è«‹</h2>
                    </div>
                    
                    <div className="p-4 space-y-4">
                      {/* æœƒè­°å®¤é¸æ“‡ */}
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          ğŸ  é¸æ“‡æœƒè­°å®¤ <span className="text-red-500">*</span>
                        </label>
                        <select
                          name="roomId"
                          value={formData.roomId}
                          onChange={handleInputChange}
                          className={`w-full p-3 border-2 rounded-lg text-base focus:outline-none transition-colors ${
                            formData.roomId 
                              ? 'border-blue-500 bg-blue-50' 
                              : 'border-gray-300 focus:border-blue-500'
                          }`}
                        >
                          <option value="">è«‹é¸æ“‡æœƒè­°å®¤</option>
                          {rooms.map(room => (
                            <option key={room.id} value={room.id}>
                              {room.name}
                            </option>
                          ))}
                        </select>
                      </div>

                      {/* å€Ÿç”¨å–®ä½ */}
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          ğŸ¢ å€Ÿç”¨å–®ä½ <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="text"
                          name="department"
                          value={formData.department}
                          onChange={handleInputChange}
                          className="w-full p-3 border-2 border-gray-300 rounded-lg text-base focus:border-blue-500 focus:outline-none"
                          placeholder="è«‹è¼¸å…¥å–®ä½åç¨±"
                        />
                      </div>

                      {/* å€Ÿç”¨äºº */}
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          ğŸ‘¤ å€Ÿç”¨äºº <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="text"
                          name="borrower"
                          value={formData.borrower}
                          onChange={handleInputChange}
                          className="w-full p-3 border-2 border-gray-300 rounded-lg text-base focus:border-blue-500 focus:outline-none"
                          placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å"
                        />
                      </div>

                      {/* åˆ†æ©Ÿè™Ÿç¢¼ */}
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          ğŸ“ åˆ†æ©Ÿè™Ÿç¢¼ <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="tel"
                          name="extension"
                          value={formData.extension}
                          onChange={handleInputChange}
                          className="w-full p-3 border-2 border-gray-300 rounded-lg text-base focus:border-blue-500 focus:outline-none"
                          placeholder="è«‹è¼¸å…¥åˆ†æ©Ÿè™Ÿç¢¼"
                        />
                      </div>

                      {/* å€Ÿç”¨æ—¥æœŸ */}
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          ğŸ“… å€Ÿç”¨æ—¥æœŸ <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="date"
                          name="date"
                          value={formData.date}
                          onChange={handleInputChange}
                          min={new Date().toISOString().split('T')[0]}
                          className="w-full p-3 border-2 border-gray-300 rounded-lg text-base focus:border-blue-500 focus:outline-none"
                        />
                      </div>

                      {/* å€Ÿç”¨æ™‚é–“ */}
                      <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          â° å€Ÿç”¨æ™‚é–“ <span className="text-red-500">*</span>
                        </label>
                        <input
                          type="time"
                          name="startTime"
                          value={formData.startTime}
                          onChange={handleInputChange}
                          className="w-full p-3 border-2 border-gray-300 rounded-lg text-base focus:border-blue-500 focus:outline-none"
                        />
                      </div>
                    </div>

                    {/* æäº¤æŒ‰éˆ• */}
                    <div className="p-4 bg-gray-50 rounded-b-lg">
                      <button
                        onClick={handleUserBookingSubmit}
                        className="w-full bg-green-500 text-white py-4 rounded-lg text-lg font-bold hover:bg-green-600 transition-colors shadow-lg"
                      >
                        âœ… ç¢ºèªå€Ÿç”¨
                      </button>
                    </div>
                  </div>

                  {/* ä½¿ç”¨æé†’ */}
                  <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4">
                    <div className="flex items-start space-x-3">
                      <div className="text-xl">ğŸ’¡</div>
                      <div>
                        <h3 className="font-medium text-yellow-800 mb-2">ä½¿ç”¨æé†’</h3>
                        <ul className="text-sm text-yellow-700 space-y-1">
                          <li>â€¢ å¡«å¯«å®Œæˆå¾Œè«‹åˆ°æ«ƒå°ç´¢å–é‘°åŒ™</li>
                          <li>â€¢ è«‹æº–æ™‚ä½¿ç”¨æœƒè­°å®¤</li>
                          <li>â€¢ ä½¿ç”¨å®Œç•¢è«‹æ­¸é‚„é‘°åŒ™</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>

                {/* ç®¡ç†å“¡ç™»å…¥å½ˆçª— */}
                {showLoginModal && (
                  <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg shadow-2xl w-full max-w-sm">
                      <div className="p-6">
                        <h3 className="text-xl font-bold text-center text-gray-800 mb-6">
                          ğŸ” ç®¡ç†å“¡ç™»å…¥
                        </h3>
                        
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                              ğŸ‘¤ å¸³è™Ÿ
                            </label>
                            <input
                              type="text"
                              name="username"
                              value={loginData.username}
                              onChange={handleLoginInputChange}
                              className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                              placeholder="è«‹è¼¸å…¥ç®¡ç†å“¡å¸³è™Ÿ"
                            />
                          </div>
                          
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                              ğŸ”’ å¯†ç¢¼
                            </label>
                            <input
                              type="password"
                              name="password"
                              value={loginData.password}
                              onChange={handleLoginInputChange}
                              className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                              placeholder="è«‹è¼¸å…¥å¯†ç¢¼"
                              onKeyPress={(e) => {
                                if (e.key === 'Enter') {
                                  handleAdminLogin();
                                }
                              }}
                            />
                          </div>
                        </div>
                        
                        <div className="flex space-x-3 mt-6">
                          <button
                            onClick={() => {
                              setShowLoginModal(false);
                              setLoginData({ username: '', password: '' });
                            }}
                            className="flex-1 bg-gray-500 text-white py-3 rounded-lg font-medium hover:bg-gray-600 transition-colors"
                          >
                            å–æ¶ˆ
                          </button>
                          <button
                            onClick={handleAdminLogin}
                            className="flex-1 bg-blue-500 text-white py-3 rounded-lg font-medium hover:bg-blue-600 transition-colors"
                          >
                            ç™»å…¥
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            );
          }

          // ç®¡ç†å“¡ä»‹é¢ï¼ˆå¾Œå°ï¼‰
          return (
            <div className="min-h-screen bg-gray-50 p-4">
              <div className="max-w-7xl mx-auto">
                    {/* ç®¡ç†å“¡æ¨™é¡Œ */}
                    <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                      <div className="flex justify-between items-center">
                        <div>
                          <h1 className="text-3xl font-bold text-gray-800">
                            ğŸ› ï¸ æœƒè­°å®¤ç®¡ç†å¾Œå°
                          </h1>
                          <p className="text-gray-600 mt-1">ç®¡ç†å“¡å°ˆç”¨ - è¨˜éŒ„æŸ¥çœ‹èˆ‡æ­¸é‚„åŠŸèƒ½</p>
                        </div>
                        <div className="flex flex-wrap gap-2">
                          <button
                            onClick={showSyncInfo}
                            className="bg-yellow-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-yellow-600 transition-colors"
                          >
                            ğŸ“±ğŸ’» åŒæ­¥èªªæ˜
                          </button>
                          <button
                            onClick={() => setShowManualAdd(true)}
                            className="bg-indigo-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-indigo-600 transition-colors"
                          >
                            â• æ‰‹å‹•æ–°å¢
                          </button>
                          <button
                            onClick={exportData}
                            className="bg-green-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-green-600 transition-colors"
                          >
                            ğŸ“¤ åŒ¯å‡ºè¨˜éŒ„
                          </button>
                          <label className="bg-purple-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-purple-600 transition-colors cursor-pointer">
                            ğŸ“¥ åŒ¯å…¥è¨˜éŒ„
                            <input
                              type="file"
                              accept=".json"
                              onChange={importData}
                              className="hidden"
                            />
                          </label>
                          <button
                            onClick={() => setSystemMode('user')}
                            className="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors"
                          >
                            ğŸ‘¤ åˆ‡æ›åˆ°ä½¿ç”¨è€…ä»‹é¢
                          </button>
                        </div>
                      </div>
                    </div>

                {/* è¨˜éŒ„ç®¡ç†é é¢ */}
                <div className="bg-white rounded-lg shadow-md p-6">
                  <h2 className="text-2xl font-bold mb-6 text-gray-800">ğŸ“‹ å€Ÿç”¨è¨˜éŒ„ç®¡ç†</h2>
                  
                  {/* è¨˜éŒ„é¡å‹åˆ‡æ› */}
                  <div className="flex space-x-4 mb-6">
                    <button
                      onClick={() => setRecordView('current')}
                      className={`px-4 py-2 rounded-lg font-medium ${
                        recordView === 'current'
                          ? 'bg-green-500 text-white'
                          : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                      }`}
                    >
                      ğŸŸ¢ ç›®å‰å€Ÿç”¨ä¸­ ({bookings.filter(b => b.status === 'å€Ÿç”¨ä¸­').length})
                    </button>
                    <button
                      onClick={() => setRecordView('all')}
                      className={`px-4 py-2 rounded-lg font-medium ${
                        recordView === 'all'
                          ? 'bg-blue-500 text-white'
                          : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                      }`}
                    >
                      ğŸ“‹ å…¨éƒ¨è¨˜éŒ„ ({bookings.length})
                    </button>
                  </div>

                  {(() => {
                    let filteredBookings = bookings;
                    if (recordView === 'current') {
                      filteredBookings = bookings.filter(b => b.status === 'å€Ÿç”¨ä¸­');
                    }

                    return filteredBookings.length === 0 ? (
                      <div className="text-center py-12">
                        <div className="text-6xl mb-4">ğŸ“­</div>
                        <p className="text-xl text-gray-500">
                          {recordView === 'current' ? 'ç›®å‰æ²’æœ‰å€Ÿç”¨ä¸­çš„è¨˜éŒ„' : 'ç›®å‰æ²’æœ‰ä»»ä½•è¨˜éŒ„'}
                        </p>
                      </div>
                    ) : (
                      <div>
                        {/* ç®¡ç†æ“ä½œæŒ‰éˆ• */}
                        {recordView === 'current' && (
                          <div className="mb-6 flex space-x-4 bg-gray-50 p-4 rounded-lg">
                            <button
                              onClick={returnSelectedBookings}
                              className="bg-orange-500 text-white px-6 py-3 rounded-lg font-bold hover:bg-orange-600 transition-colors"
                            >
                              ğŸ”„ æ­¸é‚„é¸ä¸­çš„è¨˜éŒ„
                            </button>
                            <div className="text-gray-600 flex items-center bg-white px-4 py-3 rounded-lg">
                              å·²é¸æ“‡: <span className="font-bold text-blue-600 ml-1">{selectedBookings.length}</span> ç­†
                            </div>
                          </div>
                        )}

                        {/* è¨˜éŒ„åˆ—è¡¨ */}
                        <div className="space-y-4">
                          {filteredBookings.map(booking => (
                            <div 
                              key={booking.id} 
                              className={`border-2 rounded-lg p-6 transition-all ${
                                selectedBookings.includes(booking.id)
                                  ? 'border-blue-500 bg-blue-50'
                                  : 'border-gray-200 hover:shadow-md'
                              }`}
                            >
                              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 items-center">
                                {/* è¤‡é¸æ¡† + æœƒè­°å®¤ */}
                                <div className="flex items-center space-x-3">
                                  {recordView === 'current' && booking.status === 'å€Ÿç”¨ä¸­' && (
                                    <input
                                      type="checkbox"
                                      checked={selectedBookings.includes(booking.id)}
                                      onChange={() => handleCheckboxChange(booking.id)}
                                      className="w-5 h-5 text-blue-600 border-2 border-gray-300 rounded focus:ring-blue-500"
                                    />
                                  )}
                                  <div>
                                    <div className="text-lg font-bold text-blue-600">
                                      ğŸ  {booking.roomName}
                                    </div>
                                  </div>
                                </div>

                                {/* å€Ÿç”¨äººè³‡è¨Š */}
                                <div>
                                  <div className="font-medium text-gray-800">
                                    ğŸ¢ {booking.department}
                                  </div>
                                  <div className="font-medium text-gray-800">
                                    ğŸ‘¤ {booking.borrower}
                                  </div>
                                  <div className="text-gray-600 text-sm">
                                    ğŸ“ åˆ†æ©Ÿ: {booking.extension}
                                  </div>
                                </div>

                                {/* æ™‚é–“è³‡è¨Š */}
                                <div>
                                  <div className="text-gray-600 text-sm">
                                    ğŸ“… {booking.date}
                                  </div>
                                  <div className="text-gray-600 text-sm">
                                    â° {booking.startTime}
                                  </div>
                                </div>

                                {/* ç‹€æ…‹ */}
                                <div>
                                  <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                                    booking.status === 'å€Ÿç”¨ä¸­'
                                      ? 'bg-green-100 text-green-800'
                                      : 'bg-gray-100 text-gray-800'
                                  }`}>
                                    {booking.status === 'å€Ÿç”¨ä¸­' ? 'âœ…' : 'ğŸ”„'} {booking.status}
                                  </span>
                                  {booking.returnTime && (
                                    <div className="text-xs text-gray-500 mt-1">
                                      ğŸ”„ {booking.returnTime}
                                    </div>
                                  )}
                                </div>

                                {/* ID */}
                                <div className="text-sm text-gray-500">
                                  ID: {booking.id}
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    );
                  })()}
                </div>

                {/* æ‰‹å‹•æ–°å¢è¨˜éŒ„å½ˆçª— */}
                {showManualAdd && (
                  <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div className="bg-white rounded-lg shadow-2xl w-full max-w-md">
                      <div className="p-6">
                        <h3 className="text-xl font-bold text-center text-gray-800 mb-6">
                          â• æ‰‹å‹•æ–°å¢å€Ÿç”¨è¨˜éŒ„
                        </h3>
                        <p className="text-sm text-gray-600 mb-4 text-center">
                          å¦‚æœåŒäº‹ç”¨æ‰‹æ©Ÿå€Ÿç”¨ä½†è¨˜éŒ„æ²’åŒæ­¥ï¼Œå¯åœ¨æ­¤æ‰‹å‹•æ–°å¢
                        </p>
                        
                        <div className="space-y-4">
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                              ğŸ  æœƒè­°å®¤ <span className="text-red-500">*</span>
                            </label>
                            <select
                              name="roomId"
                              value={manualFormData.roomId}
                              onChange={handleManualInputChange}
                              className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                            >
                              <option value="">è«‹é¸æ“‡æœƒè­°å®¤</option>
                              {rooms.map(room => (
                                <option key={room.id} value={room.id}>
                                  {room.name}
                                </option>
                              ))}
                            </select>
                          </div>
                          
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                              ğŸ¢ å€Ÿç”¨å–®ä½ <span className="text-red-500">*</span>
                            </label>
                            <input
                              type="text"
                              name="department"
                              value={manualFormData.department}
                              onChange={handleManualInputChange}
                              className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                              placeholder="è«‹è¼¸å…¥å–®ä½åç¨±"
                            />
                          </div>
                          
                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                              ğŸ‘¤ å€Ÿç”¨äºº <span className="text-red-500">*</span>
                            </label>
                            <input
                              type="text"
                              name="borrower"
                              value={manualFormData.borrower}
                              onChange={handleManualInputChange}
                              className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                              placeholder="è«‹è¼¸å…¥å€Ÿç”¨äººå§“å"
                            />
                          </div>

                          <div>
                            <label className="block text-sm font-medium text-gray-700 mb-2">
                              ğŸ“ åˆ†æ©Ÿè™Ÿç¢¼ <span className="text-red-500">*</span>
                            </label>
                            <input
                              type="text"
                              name="extension"
                              value={manualFormData.extension}
                              onChange={handleManualInputChange}
                              className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                              placeholder="è«‹è¼¸å…¥åˆ†æ©Ÿè™Ÿç¢¼"
                            />
                          </div>

                          <div className="grid grid-cols-2 gap-4">
                            <div>
                              <label className="block text-sm font-medium text-gray-700 mb-2">
                                ğŸ“… æ—¥æœŸ <span className="text-red-500">*</span>
                              </label>
                              <input
                                type="date"
                                name="date"
                                value={manualFormData.date}
                                onChange={handleManualInputChange}
                                className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                              />
                            </div>

                            <div>
                              <label className="block text-sm font-medium text-gray-700 mb-2">
                                â° æ™‚é–“ <span className="text-red-500">*</span>
                              </label>
                              <input
                                type="time"
                                name="startTime"
                                value={manualFormData.startTime}
                                onChange={handleManualInputChange}
                                className="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none"
                              />
                            </div>
                          </div>
                        </div>
                        
                        <div className="flex space-x-3 mt-6">
                          <button
                            onClick={() => {
                              setShowManualAdd(false);
                              setManualFormData({
                                roomId: '',
                                department: '',
                                borrower: '',
                                extension: '',
                                date: '',
                                startTime: ''
                              });
                            }}
                            className="flex-1 bg-gray-500 text-white py-3 rounded-lg font-medium hover:bg-gray-600 transition-colors"
                          >
                            å–æ¶ˆ
                          </button>
                          <button
                            onClick={handleManualAdd}
                            className="flex-1 bg-indigo-500 text-white py-3 rounded-lg font-medium hover:bg-indigo-600 transition-colors"
                          >
                            æ–°å¢è¨˜éŒ„
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        }

        ReactDOM.render(<MeetingRoomSystem />, document.getElementById('root'));
    </script>
</body>
</html>
