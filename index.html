<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊúÉË≠∞ÂÆ§ÂÄüÁî®Á≥ªÁµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .header h1 {
            font-size: 24px;
            color: #1976d2;
            margin: 12px 0 8px 0;
        }
        
        .header p {
            color: #666;
            font-size: 14px;
        }
        
        .admin-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            background: #666;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .admin-btn:hover {
            background: #555;
        }
        
        .form-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .form-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .form-header h2 {
            color: #333;
            font-size: 18px;
        }
        
        .form-body {
            padding: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
            font-size: 14px;
        }
        
        .required {
            color: #dc3545;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #1976d2;
        }
        
        .btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 16px;
        }
        
        .btn:hover {
            background: #45a049;
        }
        
        .reminder {
            background: #fff8e1;
            border: 1px solid #ffecb3;
            border-radius: 8px;
            padding: 16px;
            margin-top: 24px;
        }
        
        .reminder h3 {
            color: #f57f17;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .reminder ul {
            color: #f57f17;
            font-size: 14px;
            margin-left: 20px;
        }
        
        .reminder li {
            margin-bottom: 4px;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        .modal h3 {
            text-align: center;
            margin-bottom: 24px;
            font-size: 18px;
            color: #333;
        }
        
        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }
        
        .btn-secondary {
            background: #6c757d;
            flex: 1;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-primary {
            background: #1976d2;
            flex: 1;
        }
        
        .btn-primary:hover {
            background: #1565c0;
        }
        
        .admin-container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }
        
        .admin-title h1 {
            font-size: 24px;
            color: #333;
            margin-bottom: 4px;
        }
        
        .admin-title p {
            color: #666;
            font-size: 14px;
        }
        
        .admin-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
        }
        
        .btn-indigo {
            background: #6366f1;
            color: white;
        }
        
        .btn-indigo:hover {
            background: #5856eb;
        }
        
        .tabs {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .tab {
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .tab.active {
            background: #4caf50;
            color: white;
        }
        
        .tab:not(.active) {
            background: #e9ecef;
            color: #666;
        }
        
        .tab:not(.active):hover {
            background: #dee2e6;
        }
        
        .records-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .record-item {
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .record-item:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .record-item.selected {
            border-color: #1976d2;
            background: #e3f2fd;
        }
        
        .record-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        @media (min-width: 768px) {
            .record-grid {
                grid-template-columns: auto 1fr auto auto auto;
                align-items: center;
            }
        }
        
        .record-info {
            font-size: 14px;
        }
        
        .record-info strong {
            color: #333;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-active {
            background: #e8f5e8;
            color: #2e7d32;
        }
        
        .status-returned {
            background: #f5f5f5;
            color: #666;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .empty-state .icon {
            font-size: 48px;
            margin-bottom: 16px;
        }
        
        .management-actions {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 24px;
            display: flex;
            gap: 16px;
            align-items: center;
        }
        
        .btn-warning {
            background: #ff9800;
            color: white;
            padding: 12px 24px;
            font-weight: bold;
        }
        
        .btn-warning:hover {
            background: #f57c00;
        }
        
        .selected-count {
            background: white;
            padding: 12px 16px;
            border-radius: 6px;
            color: #666;
        }
        
        .hidden {
            display: none;
        }
        
        .checkbox {
            width: 18px;
            height: 18px;
            margin-right: 12px;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="container">
            <!-- ‰ΩøÁî®ËÄÖ‰ªãÈù¢ -->
            <div id="user-interface">
                <!-- Ê®ôÈ°å -->
                <div class="header">
                    <div style="font-size: 32px;">üè¢</div>
                    <h1>ÊúÉË≠∞ÂÆ§ÂÄüÁî®Á≥ªÁµ±</h1>
                    <p>Ë´ãÂ°´ÂØ´ÂÄüÁî®Ë≥áË®ä</p>
                    <button class="admin-btn" onclick="showLogin()">üîß ÁÆ°ÁêÜÂì°</button>
                </div>

                <!-- ÂÄüÁî®Ë°®ÂñÆ -->
                <div class="form-container">
                    <div class="form-header">
                        <h2>üìù ÂÄüÁî®Áî≥Ë´ã</h2>
                        <p style="margin-top: 4px; color: #666; font-size: 14px;">Ë´ãÂ°´ÂØ´ÂÆåÊï¥Ë≥áË®ä</p>
                    </div>
                    
                    <div class="form-body">
                        <div class="form-group">
                            <label>üè† ÈÅ∏ÊìáÊúÉË≠∞ÂÆ§ <span class="required">*</span></label>
                            <select id="roomId" class="form-control">
                                <option value="">Ë´ãÈÅ∏ÊìáÊúÉË≠∞ÂÆ§</option>
                                <option value="1">Á¨¨‰∏ÄÊúÉË≠∞ÂÆ§</option>
                                <option value="2">‰∫åÊúüË¨õÂ†Ç</option>
                                <option value="3">ÂêàÂøÉÊúÉË≠∞ÂÆ§</option>
                                <option value="4">ÂíåÊ∞£ÊúÉË≠∞ÂÆ§</option>
                                <option value="5">‰∫íÊÑõÊúÉË≠∞ÂÆ§</option>
                                <option value="6">Ë≤¥Ë≥ìÂÆ§</option>
                                <option value="7">ÂçîÂäõË¨õÂ†Ç</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>üè¢ ÂÄüÁî®ÂñÆ‰Ωç <span class="required">*</span></label>
                            <input type="text" id="department" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÂñÆ‰ΩçÂêçÁ®±">
                        </div>

                        <div class="form-group">
                            <label>üë§ ÂÄüÁî®‰∫∫ <span class="required">*</span></label>
                            <input type="text" id="borrower" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑÂßìÂêç">
                        </div>

                        <div class="form-group">
                            <label>üìû ÂàÜÊ©üËôüÁ¢º <span class="required">*</span></label>
                            <input type="tel" id="extension" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÂàÜÊ©üËôüÁ¢º">
                        </div>

                        <div class="form-group">
                            <label>üìÖ ÂÄüÁî®Êó•Êúü <span class="required">*</span></label>
                            <input type="date" id="date" class="form-control">
                        </div>

                        <div class="form-group">
                            <label>‚è∞ ÂÄüÁî®ÊôÇÈñì <span class="required">*</span></label>
                            <input type="time" id="startTime" class="form-control">
                        </div>

                        <button class="btn" onclick="submitBooking()">‚úÖ Á¢∫Ë™çÂÄüÁî®</button>
                    </div>
                </div>

                <!-- ‰ΩøÁî®ÊèêÈÜí -->
                <div class="reminder">
                    <h3>üí° ‰ΩøÁî®ÊèêÈÜí</h3>
                    <ul>
                        <li>Â°´ÂØ´ÂÆåÊàêÂæåË´ãÂà∞Ê´ÉÂè∞Á¥¢ÂèñÈë∞Âåô</li>
                        <li>Ë´ãÊ∫ñÊôÇ‰ΩøÁî®ÊúÉË≠∞ÂÆ§</li>
                        <li>‰ΩøÁî®ÂÆåÁï¢Ë´ãÊ≠∏ÈÇÑÈë∞Âåô</li>
                    </ul>
                </div>
            </div>

            <!-- ÁÆ°ÁêÜÂì°‰ªãÈù¢ -->
            <div id="admin-interface" class="hidden">
                <div class="admin-container">
                    <div class="admin-header">
                        <div class="admin-title">
                            <h1>üõ†Ô∏è ÊúÉË≠∞ÂÆ§ÁÆ°ÁêÜÂæåÂè∞</h1>
                            <p>ÁÆ°ÁêÜÂì°Â∞àÁî® - Ë®òÈåÑÊü•ÁúãËàáÊ≠∏ÈÇÑÂäüËÉΩ</p>
                        </div>
                        <div class="admin-buttons">
                            <button class="btn-small btn-indigo" onclick="showManualAdd()">‚ûï ÊâãÂãïÊñ∞Â¢û</button>
                            <button class="btn-small btn-secondary" onclick="switchToUser()">üë§ ÂàáÊèõÂà∞‰ΩøÁî®ËÄÖ‰ªãÈù¢</button>
                        </div>
                    </div>

                    <h2 style="margin-bottom: 24px; color: #333;">üìã ÂÄüÁî®Ë®òÈåÑÁÆ°ÁêÜ</h2>
                    
                    <!-- Ë®òÈåÑÈ°ûÂûãÂàáÊèõ -->
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('current')" id="current-tab">
                            üü¢ ÁõÆÂâçÂÄüÁî®‰∏≠ (<span id="current-count">0</span>)
                        </button>
                        <button class="tab" onclick="switchTab('all')" id="all-tab">
                            üìã ÂÖ®ÈÉ®Ë®òÈåÑ (<span id="all-count">0</span>)
                        </button>
                    </div>

                    <!-- ÁÆ°ÁêÜÊìç‰Ωú -->
                    <div id="management-actions" class="management-actions hidden">
                        <button class="btn btn-warning" onclick="returnSelected()">üîÑ Ê≠∏ÈÇÑÈÅ∏‰∏≠ÁöÑË®òÈåÑ</button>
                        <div class="selected-count">
                            Â∑≤ÈÅ∏Êìá: <span id="selected-count" style="font-weight: bold; color: #1976d2;">0</span> Á≠Ü
                        </div>
                    </div>

                    <!-- Ë®òÈåÑÂàóË°® -->
                    <div id="records-container">
                        <div class="empty-state">
                            <div class="icon">üì≠</div>
                            <p>ÁõÆÂâçÊ≤íÊúâ‰ªª‰ΩïË®òÈåÑ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÁôªÂÖ•ÂΩàÁ™ó -->
    <div id="login-modal" class="modal hidden">
        <div class="modal-content">
            <h3>üîê ÁÆ°ÁêÜÂì°ÁôªÂÖ•</h3>
            <div class="form-group">
                <label>üë§ Â∏≥Ëôü</label>
                <input type="text" id="username" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÁÆ°ÁêÜÂì°Â∏≥Ëôü">
            </div>
            <div class="form-group">
                <label>üîí ÂØÜÁ¢º</label>
                <input type="password" id="password" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÂØÜÁ¢º">
            </div>
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="hideLogin()">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="login()">ÁôªÂÖ•</button>
            </div>
        </div>
    </div>

    <!-- ÊâãÂãïÊñ∞Â¢ûÂΩàÁ™ó -->
    <div id="manual-add-modal" class="modal hidden">
        <div class="modal-content">
            <h3>‚ûï ÊâãÂãïÊñ∞Â¢ûË®òÈåÑ</h3>
            <div class="form-group">
                <label>ÊúÉË≠∞ÂÆ§ <span class="required">*</span></label>
                <select id="manual-roomId" class="form-control">
                    <option value="">Ë´ãÈÅ∏ÊìáÊúÉË≠∞ÂÆ§</option>
                    <option value="1">Á¨¨‰∏ÄÊúÉË≠∞ÂÆ§</option>
                    <option value="2">‰∫åÊúüË¨õÂ†Ç</option>
                    <option value="3">ÂêàÂøÉÊúÉË≠∞ÂÆ§</option>
                    <option value="4">ÂíåÊ∞£ÊúÉË≠∞ÂÆ§</option>
                    <option value="5">‰∫íÊÑõÊúÉË≠∞ÂÆ§</option>
                    <option value="6">Ë≤¥Ë≥ìÂÆ§</option>
                    <option value="7">ÂçîÂäõË¨õÂ†Ç</option>
                </select>
            </div>
            <div class="form-group">
                <label>ÂÄüÁî®ÂñÆ‰Ωç <span class="required">*</span></label>
                <input type="text" id="manual-department" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÂñÆ‰ΩçÂêçÁ®±">
            </div>
            <div class="form-group">
                <label>ÂÄüÁî®‰∫∫ <span class="required">*</span></label>
                <input type="text" id="manual-borrower" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÂÄüÁî®‰∫∫ÂßìÂêç">
            </div>
            <div class="form-group">
                <label>ÂàÜÊ©üËôüÁ¢º <span class="required">*</span></label>
                <input type="tel" id="manual-extension" class="form-control" placeholder="Ë´ãËº∏ÂÖ•ÂàÜÊ©üËôüÁ¢º">
            </div>
            <div class="form-group">
                <label>ÂÄüÁî®Êó•Êúü <span class="required">*</span></label>
                <input type="date" id="manual-date" class="form-control">
            </div>
            <div class="form-group">
                <label>ÂÄüÁî®ÊôÇÈñì <span class="required">*</span></label>
                <input type="time" id="manual-startTime" class="form-control">
            </div>
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="hideManualAdd()">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="submitManualAdd()">Êñ∞Â¢û</button>
            </div>
        </div>
    </div>

    <script>
        // ÂÖ®ÂüüËÆäÊï∏
        let bookings = [];
        let selectedBookings = [];
        let currentView = 'current';

        const rooms = {
            1: 'Á¨¨‰∏ÄÊúÉË≠∞ÂÆ§',
            2: '‰∫åÊúüË¨õÂ†Ç',
            3: 'ÂêàÂøÉÊúÉË≠∞ÂÆ§',
            4: 'ÂíåÊ∞£ÊúÉË≠∞ÂÆ§',
            5: '‰∫íÊÑõÊúÉË≠∞ÂÆ§',
            6: 'Ë≤¥Ë≥ìÂÆ§',
            7: 'ÂçîÂäõË¨õÂ†Ç'
        };

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            // Ë®≠ÂÆöÊúÄÂ∞èÊó•ÊúüÁÇ∫‰ªäÂ§©
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').min = today;
            
            // Á∂ÅÂÆö Enter ÈçµÁôªÂÖ•
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
        });

        // È°ØÁ§∫ÁôªÂÖ•ÂΩàÁ™ó
        function showLogin() {
            document.getElementById('login-modal').classList.remove('hidden');
        }

        // Èö±ËóèÁôªÂÖ•ÂΩàÁ™ó
        function hideLogin() {
            document.getElementById('login-modal').classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        // ÁÆ°ÁêÜÂì°ÁôªÂÖ•
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === 'hl1234' && password === 'admin1234') {
                hideLogin();
                switchToAdmin();
                alert('ÁôªÂÖ•ÊàêÂäüÔºÅ');
            } else {
                alert('Â∏≥ËôüÊàñÂØÜÁ¢ºÈåØË™§ÔºÅ');
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
            }
        }

        // ÂàáÊèõÂà∞ÁÆ°ÁêÜÂì°‰ªãÈù¢
        function switchToAdmin() {
            document.getElementById('user-interface').classList.add('hidden');
            document.getElementById('admin-interface').classList.remove('hidden');
            updateRecordsDisplay();
        }

        // ÂàáÊèõÂà∞‰ΩøÁî®ËÄÖ‰ªãÈù¢
        function switchToUser() {
            document.getElementById('admin-interface').classList.add('hidden');
            document.getElementById('user-interface').classList.remove('hidden');
            selectedBookings = [];
        }

        // Êèê‰∫§ÂÄüÁî®Áî≥Ë´ã
        function submitBooking() {
            const roomId = document.getElementById('roomId').value;
            const department = document.getElementById('department').value;
            const borrower = document.getElementById('borrower').value;
            const extension = document.getElementById('extension').value;
            const date = document.getElementById('date').value;
            const startTime = document.getElementById('startTime').value;

            // È©óË≠âÂøÖÂ°´Ê¨Ñ‰Ωç
            if (!roomId || !department || !borrower || !extension || !date || !startTime) {
                alert('Ë´ãÂ°´ÂØ´ÊâÄÊúâÂøÖÂ°´Ê¨Ñ‰ΩçÔºÅ');
                return;
            }

            // Ê™¢Êü•ÊôÇÈñìË°ùÁ™Å
            const hasConflict = bookings.some(booking => 
                booking.roomId === parseInt(roomId) &&
                booking.date === date &&
                booking.startTime === startTime &&
                booking.status === 'ÂÄüÁî®‰∏≠'
            );

            if (hasConflict) {
                alert('Ë©≤ÊúÉË≠∞ÂÆ§Âú®Ê≠§ÊôÇÈñìÂ∑≤Ë¢´È†êÁ¥ÑÔºÅË´ãÈÅ∏ÊìáÂÖ∂‰ªñÊôÇÈñì„ÄÇ');
                return;
            }

            // Êñ∞Â¢ûÂÄüÁî®Ë®òÈåÑ
            const newBooking = {
                id: Date.now(),
                roomId: parseInt(roomId),
                roomName: rooms[roomId],
                department: department,
                borrower: borrower,
                extension: extension,
                date: date,
                startTime: startTime,
                status: 'ÂÄüÁî®‰∏≠',
                bookingTime: new Date().toLocaleString()
            };

            bookings.push(newBooking);

            // Ê∏ÖÁ©∫Ë°®ÂñÆ
            document.getElementById('roomId').value = '';
            document.getElementById('department').value = '';
            document.getElementById('borrower').value = '';
            document.getElementById('extension').value = '';
            document.getElementById('date').value = '';
            document.getElementById('startTime').value = '';

            alert(`ÂÄüÁî®ÊàêÂäüÔºÅ\n\nÊúÉË≠∞ÂÆ§Ôºö${rooms[roomId]}\nÂÄüÁî®ÂñÆ‰ΩçÔºö${department}\nÂÄüÁî®‰∫∫Ôºö${borrower}\n\nË´ãÂà∞Ê´ÉÂè∞Á¥¢ÂèñÈë∞Âåô„ÄÇ`);
        }

        // ÂàáÊèõË®òÈåÑÈ°ûÂûãÊ®ôÁ±§
        function switchTab(view) {
            currentView = view;
            
            // Êõ¥Êñ∞Ê®ôÁ±§Ê®£Âºè
            document.getElementById('current-tab').classList.toggle('active', view === 'current');
            document.getElementById('all-tab').classList.toggle('active', view === 'all');
            
            // ÈáçÁΩÆÈÅ∏Êìá
            selectedBookings = [];
            
            updateRecordsDisplay();
        }

        // Êõ¥Êñ∞Ë®òÈåÑÈ°ØÁ§∫
        function updateRecordsDisplay() {
            const currentBookings = bookings.filter(b => b.status === 'ÂÄüÁî®‰∏≠');
            
            // Êõ¥Êñ∞Ë®àÊï∏
            document.getElementById('current-count').textContent = currentBookings.length;
            document.getElementById('all-count').textContent = bookings.length;
            
            let filteredBookings = currentView === 'current' ? currentBookings : bookings;
            
            const container = document.getElementById('records-container');
            const managementActions = document.getElementById('management-actions');
            
            // È°ØÁ§∫/Èö±ËóèÁÆ°ÁêÜÊìç‰Ωú
            if (currentView === 'current' && filteredBookings.length > 0) {
                managementActions.classList.remove('hidden');
            } else {
                managementActions.classList.add('hidden');
            }
            
            // Êõ¥Êñ∞ÈÅ∏ÊìáË®àÊï∏
            document.getElementById('selected-count').textContent = selectedBookings.length;
            
            if (filteredBookings.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">üì≠</div>
                        <p>${currentView === 'current' ? 'ÁõÆÂâçÊ≤íÊúâÂÄüÁî®‰∏≠ÁöÑË®òÈåÑ' : 'ÁõÆÂâçÊ≤íÊúâ‰ªª‰ΩïË®òÈåÑ'}</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = `
                <div class="records-list">
                    ${filteredBookings.map(booking => `
                        <div class="record-item ${selectedBookings.includes(booking.id) ? 'selected' : ''}">
                            <div class="record-grid">
                                <div style="display: flex; align-items: center;">
                                    ${currentView === 'current' && booking.status === 'ÂÄüÁî®‰∏≠' ? 
                                        `<input type="checkbox" class="checkbox" ${selectedBookings.includes(booking.id) ? 'checked' : ''} onchange="toggleSelection(${booking.id})">` : ''}
                                    <strong>üè† ${booking.roomName}</strong>
                                </div>
                                <div class="record-info">
                                    <div><strong>üè¢ ${booking.department}</strong></div>
                                    <div><strong>üë§ ${booking.borrower}</strong></div>
                                    <div style="color: #666; font-size: 12px;">üìû ÂàÜÊ©ü: ${booking.extension}</div>
                                </div>
                                <div class="record-info">
                                    <div>üìÖ ${booking.date}</div>
                                    <div>‚è∞ ${booking.startTime}</div>
                                </div>
                                <div>
                                    <span class="status-badge ${booking.status === 'ÂÄüÁî®‰∏≠' ? 'status-active' : 'status-returned'}">
                                        ${booking.status === 'ÂÄüÁî®‰∏≠' ? '‚úÖ' : 'üîÑ'} ${booking.status}
                                    </span>
                                    ${booking.returnTime ? `<div style="font-size: 11px; color: #666; margin-top: 4px;">üîÑ ${booking.returnTime}</div>` : ''}
                                </div>
                                <div style="color: #999; font-size: 12px;">
                                    ID: ${booking.id}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // ÂàáÊèõÈÅ∏ÊìáÁãÄÊÖã
        function toggleSelection(bookingId) {
            if (selectedBookings.includes(bookingId)) {
                selectedBookings = selectedBookings.filter(id => id !== bookingId);
            } else {
                selectedBookings.push(bookingId);
            }
            updateRecordsDisplay();
        }

        // Ê≠∏ÈÇÑÈÅ∏‰∏≠ÁöÑË®òÈåÑ
        function returnSelected() {
            if (selectedBookings.length === 0) {
                alert('Ë´ãÂÖàÈÅ∏ÊìáË¶ÅÊ≠∏ÈÇÑÁöÑË®òÈåÑÔºÅ');
                return;
            }
            
            const currentTime = new Date().toLocaleString();
            bookings = bookings.map(booking => {
                if (selectedBookings.includes(booking.id) && booking.status === 'ÂÄüÁî®‰∏≠') {
                    return {
                        ...booking,
                        status: 'Â∑≤Ê≠∏ÈÇÑ',
                        returnTime: currentTime
                    };
                }
                return booking;
            });
            
            const count = selectedBookings.length;
            selectedBookings = [];
            updateRecordsDisplay();
            alert(`Â∑≤Ê≠∏ÈÇÑ ${count} Á≠ÜË®òÈåÑÔºÅ`);
        }

        // È°ØÁ§∫ÊâãÂãïÊñ∞Â¢ûÂΩàÁ™ó
        function showManualAdd() {
            document.getElementById('manual-add-modal').classList.remove('hidden');
        }

        // Èö±ËóèÊâãÂãïÊñ∞Â¢ûÂΩàÁ™ó
        function hideManualAdd() {
            document.getElementById('manual-add-modal').classList.add('hidden');
            // Ê∏ÖÁ©∫Ë°®ÂñÆ
            document.getElementById('manual-roomId').value = '';
            document.getElementById('manual-department').value = '';
            document.getElementById('manual-borrower').value = '';
            document.getElementById('manual-extension').value = '';
            document.getElementById('manual-date').value = '';
            document.getElementById('manual-startTime').value = '';
        }

        // Êèê‰∫§ÊâãÂãïÊñ∞Â¢û
        function submitManualAdd() {
            const roomId = document.getElementById('manual-roomId').value;
            const department = document.getElementById('manual-department').value;
            const borrower = document.getElementById('manual-borrower').value;
            const extension = document.getElementById('manual-extension').value;
            const date = document.getElementById('manual-date').value;
            const startTime = document.getElementById('manual-startTime').value;

            // È©óË≠âÂøÖÂ°´Ê¨Ñ‰Ωç
            if (!roomId || !department || !borrower || !extension || !date || !startTime) {
                alert('Ë´ãÂ°´ÂØ´ÊâÄÊúâÂøÖÂ°´Ê¨Ñ‰ΩçÔºÅ');
                return;
            }

            // Ê™¢Êü•ÊôÇÈñìË°ùÁ™Å
            const hasConflict = bookings.some(booking => 
                booking.roomId === parseInt(roomId) &&
                booking.date === date &&
                booking.startTime === startTime &&
                booking.status === 'ÂÄüÁî®‰∏≠'
            );

            if (hasConflict) {
                alert('Ë©≤ÊúÉË≠∞ÂÆ§Âú®Ê≠§ÊôÇÈñìÂ∑≤Ë¢´È†êÁ¥ÑÔºÅË´ãÈÅ∏ÊìáÂÖ∂‰ªñÊôÇÈñì„ÄÇ');
                return;
            }

            // Êñ∞Â¢ûÂÄüÁî®Ë®òÈåÑ
            const newBooking = {
                id: Date.now(),
                roomId: parseInt(roomId),
                roomName: rooms[roomId],
                department: department,
                borrower: borrower,
                extension: extension,
                date: date,
                startTime: startTime,
                status: 'ÂÄüÁî®‰∏≠',
                bookingTime: new Date().toLocaleString()
            };

            bookings.push(newBooking);
            hideManualAdd();
            updateRecordsDisplay();
            alert('ÊâãÂãïË®òÈåÑÊñ∞Â¢ûÊàêÂäüÔºÅ');
        }
    </script>
</body>
</html>
